<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./style.css">
    <title>index</title>
</head>
<body>
    <main>
        <p class="title">Yunjae's Blog</p>
        
        <ul class="posts">
        </ul>
        <button type="button" class="create_btn">create</button>
    </main>
    <script>
        const $view = document.querySelector('.posts');
        const $create = document.querySelector('.create_btn');
        $create.onclick = ()=> {
            location.href = "create.html"
        }
        const url = "http://localhost:8080/";
        const getList = async ()=> {
            const res = await fetch(url+"post/api", {
                headers: {
                    "Content-Type": "application/json"
                }
            })
            
            const json = await res.json();
            console.log(json);
            const id =[];
            for (const data of json) {   
                const date = data.modData.split('-');
                $view.innerHTML+=`
                <li>
                    <img src="${url}img/${data.titleImg}" alt="이미지" class="post-img">
                    <a href="#">${data.title}</a>
                    <p class="post-subtitle">${date[0].slice(0,4)}.${date[1].slice(0,2)}.${date[2].slice(0,2)}</p>
                </li>
                `
                id.push(data._id);
            }
            const $btn2 = document.querySelectorAll('a');
            for (const i in $btn2) {
                $btn2[i].onclick=()=>{
                    sessionStorage.setItem('id',id[i]);
                }
                $btn2[i].href = "view.html"
            }
            const $btn = document.querySelectorAll('.post-img');
            for (const i in $btn) {
                $btn[i].onclick = ()=> {
                    sessionStorage.setItem('id',id[i]);
                    location.href = "view.html";
                }
            }
            
        }
        getList();
    </script>
</body>
</html>